\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}


\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{adjustbox}
\usepackage{float}
\usepackage[usenames,dvipsnames]{xcolor}

\usepackage{listings}

\lstset{
    language=Python,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue},
    stringstyle=\color{red},
    commentstyle=\color{gray},
    showstringspaces=false,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    breaklines=true,
    tabsize=4
}

% \usepackage{cmbright}

\usepackage{amsmath, amsfonts, mathtools, amsthm, amssymb}
\usepackage{stmaryrd}
\usepackage{mathrsfs}
\usepackage{cancel}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{url}

\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={black},
    citecolor={black},
    urlcolor={blue!80!black}
}

\usepackage[margin=0.8in]{geometry}

\newcommand\N{\ensuremath{\mathbb{N}}}
\newcommand\R{\ensuremath{\mathbb{R}}}
\newcommand\Z{\ensuremath{\mathbb{Z}}}
\renewcommand\O{\ensuremath{\emptyset}}
\newcommand\Q{\ensuremath{\mathbb{Q}}}
\newcommand\C{\ensuremath{\mathbb{C}}}
\let\implies\Rightarrow
\let\impliedby\Leftarrow
\let\iff\Leftrightarrow
\let\epsilon\varepsilon

% horizontal rule
\newcommand\hr{
    \noindent\rule[0.5ex]{\linewidth}{0.5pt}
}

\usepackage{tikz}
% \usepackage{tikzmark}
\usepackage{pgfplots}
\usepackage{tikz-cd}

\usetikzlibrary{calc, arrows.meta, positioning, angles, quotes, patterns}

% theorems
\usepackage{thmtools}
\usepackage{thm-restate}
\usepackage[framemethod=TikZ]{mdframed}
\mdfsetup{skipabove=1em,skipbelow=0em, innertopmargin=12pt, innerbottommargin=8pt}

\theoremstyle{definition}

\makeatletter

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
% notefont=\itshape\mdseries, notebraces={(}{)},
postheadspace=1em,
bodyfont=\normalfont,
]{thmstylecasual}


\declaretheoremstyle[
  headfont=\bfseries,
  bodyfont=\normalfont,
  mdframed={
    linewidth=0.5pt,
    rightline=false,
    topline=false,
    bottomline=false,
    linecolor=black,
    innertopmargin=6pt,
    innerbottommargin=6pt,
    leftmargin=0pt,
    innerleftmargin=8pt,
  },
  spaceabove=2pt,
  spacebelow=10pt,
  headpunct={.}
]{definitionfancystyle}

\definecolor{Wine}{RGB}{110,0,40}

\declaretheoremstyle[
  headfont=\scshape\color{Wine},
  bodyfont=\normalfont,
  notefont=\itshape,
  headpunct={~—},
  spaceabove=6pt, spacebelow=6pt,
]{ensstyle}
\declaretheoremstyle[
  headfont=\scshape\color{Wine},
  bodyfont=\normalfont,
  notefont=\itshape,
  headpunct={~—},
  spaceabove=6pt, spacebelow=6pt,
  mdframed={
      linewidth=0.5pt,
      rightline=true,
      topline=true,
      bottomline=true,
      linecolor=Wine,
      innertopmargin=8pt,
      innerbottommargin=10pt,
      leftmargin=0pt,
      innerleftmargin=8pt,
  },
]{ensdefstyle}

\declaretheoremstyle[
  headfont=\scshape\color{Wine},
  bodyfont=\normalfont,
  notefont=\itshape,
  headpunct={~—},
  spaceabove=5pt, spacebelow=5pt,
  mdframed={
    linewidth=2.5pt,
    rightline=false,
    topline=false,
    bottomline=false,
    linecolor=Wine,
    innertopmargin=8pt,
    innerbottommargin=10pt,
    leftmargin=0pt,
    innerleftmargin=8pt,
  },
]{enstheoremstyle}
\declaretheoremstyle[
  headfont=\itshape\color{Wine},
  bodyfont=\normalfont,
  notefont=\itshape,
  headpunct={~—},
  spaceabove=5pt, spacebelow=5pt,
  qed=\qedsymbol,
  mdframed={
    linewidth=0.5pt,
    rightline=false,
    topline=false,
    bottomline=false,
    linecolor=Wine,
    innertopmargin=8pt,
    innerbottommargin=10pt,
    leftmargin=0pt,
    innerleftmargin=8pt,
  },
]{ensproofstyle}

\declaretheorem[numberwithin=chapter, style=enstheoremstyle, name=Theorem]{theorem}
\declaretheorem[numberwithin=section, style=ensdefstyle, name=Definition]{definition}
\declaretheorem[sibling=definition, style=ensdefstyle, name=Corollary]{corollary}
\declaretheorem[sibling=definition, style=ensdefstyle, name=Proposition]{prop}
\declaretheorem[sibling=definition, style=ensdefstyle, name=Lemma]{lemma}
\declaretheorem[sibling=definition, style=enstheoremstyle,  name=Example]{eg}
\declaretheorem[sibling=definition, style=ensstyle,  name=Nonexample]{noneg}
\declaretheorem[sibling=definition, style=ensstyle, name=Remark]{remark}
\declaretheorem[numbered=no, style=ensproofstyle, name=Proof]{newproof}




\declaretheorem[numbered=no, style=thmstylecasual, name=Proof]{explanation}
\declaretheorem[style=thmstylecasual,  numberwithin=section, name=Exercise]{ex}
\declaretheorem[style=ensstyle, numbered=no, name=Note]{note}

% \renewenvironment{proof}[1][\proofname]{\begin{replacementproof}}{\end{replacementproof}}

% \AtEndEnvironment{eg}{\null\hfill$\diamond$}%

\newtheorem*{uovt}{UOVT}
\newtheorem*{notation}{Notation}
\newtheorem*{previouslyseen}{As previously seen}
\newtheorem*{problem}{Problem}
\newtheorem*{observe}{Observe}
\newtheorem*{property}{Property}
\newtheorem*{intuition}{Intuition}


\declaretheoremstyle[
    headfont=\bfseries\sffamily\color{RawSienna!70!black}, bodyfont=\normalfont,
    mdframed={
        linewidth=2pt,
        rightline=false, topline=false, bottomline=false,
        linecolor=RawSienna, backgroundcolor=RawSienna!5,
    }
]{todo}
\declaretheorem[numbered=no, style=todo, name=TODO]{TODO}


\usepackage{etoolbox}

\AtEndEnvironment{vb}{\null\hfill$\diamond$}%
\AtEndEnvironment{intermezzo}{\null\hfill$\diamond$}%




% http://tex.stackexchange.com/questions/22119/how-can-i-change-the-spacing-before-theorems-with-amsthm
% \def\thm@space@setup{%
%   \thm@preskip=\parskip \thm@postskip=0pt
% }

\usepackage{xifthen}

\def\testdateparts#1{\dateparts#1\relax}
\def\dateparts#1 #2 #3 #4 #5\relax{
    \marginpar{\small\textsf{\mbox{#1 #2 #3 #5}}}
}

\def\@lesson{}%
\newcommand{\lesson}[3]{
    \ifthenelse{\isempty{#3}}{%
        \def\@lesson{Lecture #1}%
    }{%
        \def\@lesson{Lecture #1: #3}%
    }%
    \subsection*{\@lesson}
    \testdateparts{#2}
}

% fancy headers
\usepackage{fancyhdr}
\pagestyle{fancy}

\fancyhead[LE, RO]{Yehor Korotenko}
% \fancyhead[RO,LE]{\@lesson}
% \fancyhead[RE,LO]{}
% \fancyfoot[LE,RO]{\thepage}
% \fancyfoot[C]{\leftmark}
% \renewcommand{\headrulewidth}{0pt}

\makeatother

% figure support (https://castel.dev/post/lecture-notes-2)
\usepackage{import}
\usepackage{xifthen}
\pdfminorversion=7
\usepackage{pdfpages}
\usepackage{transparent}
\newcommand{\incfig}[1]{%
    \def\svgwidth{\columnwidth}
    \import{./figures/}{#1.pdf_tex}
}

% %http://tex.stackexchange.com/questions/76273/multiple-pdfs-with-page-group-included-in-a-single-page-warning
\pdfsuppresswarningpagegroup=1
\pgfplotsset{compat=1.11}
\usepackage{subcaption}

\author{Yehor Korotenko}

\newcommand{\scalar}[2]{\langle #1, #2 \rangle}
\newcommand{\scalair}[1]{\left\langle #1 \right\rangle}

% fancy chapters
\usepackage{lipsum}
\usepackage[Lenny]{fncychap}
\ChNameUpperCase
\ChNumVar{\fontsize{40}{42}\usefont{OT1}{ptm}{m}{n}\selectfont}
\ChTitleVar{\Large\sc}


\setlength{\parskip}{3pt}

\usepackage{enumerate}
